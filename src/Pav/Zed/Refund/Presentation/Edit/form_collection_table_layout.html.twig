{% use "form_div_layout.html.twig" %}

{%- block form_widget -%}
    {% if compound %}
        {{- block('form_widget_compound') -}}
    {% else %}
        {{- block('form_widget_simple') -}}
    {% endif %}
{%- endblock form_widget -%}

{%- block form_widget_simple -%}
    {%- set type = type|default('text') -%}
    {%- if not disabled or type == 'hidden'-%}
        <input
                type="{{ type }}"
                class="form-control"
                {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %}/>
    {%- else  -%}
        {% if value is not empty %}{{ value }}{% endif %}
    {%- endif  -%}
{%- endblock form_widget_simple -%}

{%- block form_row -%}
    {% if form.vars.compound != true %}
        <td>
            <div class="input-group">
                {{- form_widget(form) -}}
            </div>
            {{- form_errors(form) -}}
        </td>
    {% else %}
        {{- form_widget(form) -}}
    {% endif %}
{%- endblock form_row -%}

{%- block textarea_widget -%}
    <textarea class="form-control" {{ block('widget_attributes') }}>{{ value }}</textarea>
{%- endblock textarea_widget -%}

{%- block form_start -%}
   {% set method = method|upper %}
    {%- if method in ["GET", "POST"] -%}
        {% set form_method = method %}
    {%- else -%}
        {% set form_method = "POST" %}
    {%- endif -%}
    <form name="{{ name }}" method="{{ form_method|lower }}"{% if action != '' %} action="{{ action }}"{% endif %}{% for attrname, attrvalue in attr %} {{ attrname }}="{{ attrvalue }}"{% endfor %}{% if multipart %} enctype="multipart/form-data"{% endif %}>
    {%- if form_method != method -%}
        <input type="hidden" name="_method" value="{{ method }}" />
    {%- endif -%}
    <table class="table table-striped table-bordered table-hover dataTable">
    {% if form.table_body is defined %}
        <thead>
            <tr>
                {% for headerColumn in form.table_body|first %}
                    {% set columnName = headerColumn.vars.name %}
                    {%- if "hidden" not in headerColumn.vars.block_prefixes -%}
                        <th class="sorting" id="header_{{ headerColumn.vars.name }}">
                            {% if headerColumn.vars.label %}
                                {{ headerColumn.vars.label }}
                            {% else %}
                                {{ headerColumn.vars.name }}
                            {% endif %}
                        </th>
                    {%- endif -%}
                {% endfor %}
            </tr>
        </thead>
    {% endif %}
    {{- form_widget(form.table_body) -}}
    </table>
{%- endblock form_start -%}

{%- block form_end -%}
    {%- if not render_rest is defined or render_rest -%}
        {{ form_rest(form) }}
    {%- endif -%}
    </form>
{%- endblock form_end -%}

{%- block form_widget_compound -%}
<tr role="row">
    <div {{ block('widget_container_attributes') }}>
        {%- if form.parent is empty -%}
            {{ form_errors(form) }}
        {%- endif -%}
        {{- block('form_rows') -}}
        {{- form_rest(form) -}}
    </div>
</tr>
{%- endblock form_widget_compound -%}

{%- block collection_widget -%}
    {% if prototype is defined %}
        {%- set attr = attr|merge({'data-prototype': form_row(prototype) }) -%}
    {% endif %}
    {{- block('form_widget') -}}
{%- endblock collection_widget -%}

{%- block money_widget -%}
    {%- if disabled -%}
        {{ money_pattern|replace({ '{{ widget }}': block('form_widget_simple') }) }}
    {%- else -%}
        {% set money_suffix = money_pattern|replace({'{{ widget }}': ''}) %}
        {% set new_money_pattern = '{{ widget }}<span class="input-group-addon"> ' ~ money_suffix ~ ' </span>' %}
        {{ new_money_pattern|replace({ '{{ widget }}': block('form_widget_simple') })|raw }}
    {% endif %}
{%- endblock money_widget -%}

{%- block button_row -%}
    <td>
        {{- form_widget(form) -}}
    </td>
{%- endblock button_row -%}
